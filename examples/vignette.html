<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>GAI vignette</title>

<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">GAI vignette</h1>



<div id="introduction-to-the-gai-package" class="section level1">
<h1>Introduction to the GAI package</h1>
<p>The GAI package is an extension of functionality provided by . The package provides a user interface for calculating a Generalised Abundance Index (GAI) for seasonal invertebrates, with multiple options for covariate inclusion, seasonal flight patterns and observed count distributions, along with the ability to conduct bootstraps to obtain measures uncertainty for estimated parameter and GAI values.</p>
<p>This vignette will illustrate the features available within the package by providing an example workflow on simulated data.</p>
</div>
<div id="installing-the-package-from-source" class="section level1">
<h1>Installing the Package from Source</h1>
<p>In order to install the GAI package from source, the folder containing the source code must be downloaded from Github: <a href="https://github.com/calliste-fagard-jenkin/GAI" class="uri">https://github.com/calliste-fagard-jenkin/GAI</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#install.packages(&#39;devtools&#39;)</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(devtools, <span class="dt">quietly =</span> T)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">install_github</span>(<span class="st">&quot;calliste-fagard-jenkin/GAI&quot;</span>, <span class="dt">quiet =</span> T)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(GAI)</a></code></pre></div>
</div>
<div id="preparing-data-for-the-gai-package" class="section level1">
<h1>Preparing Data for the GAI Package</h1>
<p>Let us begin by loading an example data set which is provided within the GAI package, and examining its structure. These data consist of a simulation from a mixture model with three broods, across 50 sites and 26 occasions (one survey every week from April to September, inclusive, for a given year).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># For the pipe operator:</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">data</span>(<span class="st">&quot;example_data&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">head</span>(example_data)</a></code></pre></div>
<pre><code>##   site occasion count    altitude
## 1    1        1     0  1.75733303
## 2    2        1    NA -1.62156062
## 3    3        1     0  1.32982955
## 4    4        1     2 -1.20585806
## 5    5        1     1  1.02254356
## 6    6        1    NA -0.00204768</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># The GAI package comes with a handy function to convert data.frame data to </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># a matrix of counts, to facilitate plotting. This function also checks if </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># the survey has any missing occasions, so can be a useful way of sanitising</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># a new dataset:</span></a>
<a class="sourceLine" id="cb4-5" title="5">test_data &lt;-<span class="st"> </span><span class="kw">extract_counts</span>(example_data, <span class="dt">returnDF =</span> T)<span class="op">$</span>matrix</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co"># Plot the observed densities, averaged across all sites:</span></a>
<a class="sourceLine" id="cb4-8" title="8">test_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">apply</span>(<span class="dv">2</span>, mean, <span class="dt">na.rm =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(test_data), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.6</span>), <span class="dt">lty =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb4-10" title="10">       <span class="dt">xlab =</span> <span class="st">&#39;Week&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Observed count, averaged across all sites&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Each row in our input data.frame is used to store the result of the observed count at a given site on a given occasion. We assume that the interval between each occasion is fixed, and that sites are independent. The ‘site’, ‘occasion’ and ‘count’ columns must be given these precise names to allow the GAI package to recognise them. Missing observations can be listed with an NA entry.</p>
<p>Sites and occasions can have either character or numeric names. Because of this, the GAI package will assume occasions occured in the order they first appear in the data frame. If no observations were collected for any sites on a given occasion, this occasion should still be included in the data.frame with NA entries for each site.</p>
<p>The fourth column ‘altitude’ represents a covariate (with standardised values), and will be used to illustrate how covariates can be included into different models available within the package.</p>
</div>
<div id="fitting-a-simple-model" class="section level1">
<h1>Fitting a Simple Model</h1>
<p>As described by , the Generalised Abundance Index is a model comprised of two parts. Firstly, the seasonal flight pattern describes the density of arrivals at each occasion in the study, and can be modelled either by a stopover model , a spline, or an n-component mixture model. The choice of seasonal flight pattern can be specified using the options “stopover”, “spline” and “mixture”, for each of the above options, respectively.</p>
<p>The second part of the GAI model describes the distribution of observed counts of individuals at each site on a given occasion. The package includes Poisson (“P”), Negative Binomial (“NB”) and Zero-Inflated Poisson (“ZIP”) as options for this distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># We can load the true parameter values of the simulated data set from the </span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co"># GAI package, to more easily find starting parameter values for this example:</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">data</span>(<span class="st">&quot;example_par&quot;</span>)</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co"># The &#39;options&#39; argument of the fit_GAI function is how we specify the </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co"># specific model we&#39;d like the package to fit. For mixture and stopover models</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># we can specify if each brood should be modelled to have the same standard </span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co"># deviation, and the number of broods our model should use:</span></a>
<a class="sourceLine" id="cb5-9" title="9">my_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">B =</span> <span class="dv">3</span>, <span class="dt">shared_sigma =</span> T)</a>
<a class="sourceLine" id="cb5-10" title="10"></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co"># In the case of a spline-based model, the package needs to know the number of</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co"># degrees of freedom and the degree of the splines we want to use:</span></a>
<a class="sourceLine" id="cb5-13" title="13">options_for_splines &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">df =</span> <span class="dv">20</span>, <span class="dt">degree =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-14" title="14"></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co"># The fit_GAI function includes a &#39;verbose&#39;  option, which prints the value of</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co"># the negative log-likelihood at each iteration, and also the option to </span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co"># estimate the hessian matrix of the parameters, to obtain their </span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co"># variance covariance matrix:</span></a>
<a class="sourceLine" id="cb5-19" title="19">my_mixture_GAI &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> example_par,</a>
<a class="sourceLine" id="cb5-20" title="20">                          <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>,</a>
<a class="sourceLine" id="cb5-21" title="21">                          <span class="dt">dist_choice =</span> <span class="st">&quot;ZIP&quot;</span>, <span class="dt">options =</span> my_options,</a>
<a class="sourceLine" id="cb5-22" title="22">                          <span class="dt">verbose =</span> T, <span class="dt">hessian =</span> T)</a></code></pre></div>
<pre><code>## negative log likelihood for iteration 1 is 2747.375 
## negative log likelihood for iteration 2 is 1949.516 
## negative log likelihood for iteration 3 is 1949.362 
## final negative log likelihood value is 1949.361 
## performing final iteration to find hessian</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Print the MLEs to show the model has fitted correctly:</span></a>
<a class="sourceLine" id="cb7-2" title="2">my_mixture_GAI<span class="op">$</span>par</a></code></pre></div>
<pre><code>##        mu1        mu2        mu3      sigma         w1         w2   dist.par 
##  1.4337144  2.2419175  2.1685968  0.6185839 -1.8263218  0.8410108  1.0687630</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># Not forgetting to add degrees of freedom and degree of splines information,</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co"># and noting that specifying the number of broods will no longer have an </span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co"># effect:</span></a>
<a class="sourceLine" id="cb9-4" title="4">my_spline_GAI &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">DF =</span> example_data,</a>
<a class="sourceLine" id="cb9-5" title="5">                         <span class="dt">a_choice =</span> <span class="st">&quot;splines&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</a>
<a class="sourceLine" id="cb9-6" title="6">                         <span class="dt">options =</span> options_for_splines, <span class="dt">verbose =</span> T,</a>
<a class="sourceLine" id="cb9-7" title="7">                         <span class="dt">hessian =</span> T)</a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co"># Print the MLEs to show the model has fitted correctly:</span></a>
<a class="sourceLine" id="cb9-10" title="10">my_spline_GAI<span class="op">$</span>par</a></code></pre></div>
<pre><code>##  spline_par1  spline_par2  spline_par3  spline_par4  spline_par5  spline_par6 
##  -0.74459183  -1.13888097   0.05605385   0.29477103  -0.28232268  -1.10391896 
##  spline_par7  spline_par8  spline_par9 spline_par10 spline_par11 spline_par12 
##  -0.19763237  -0.48065819   0.69275871   1.54254613   1.85688387   0.44059246 
## spline_par13 spline_par14 spline_par15 spline_par16 spline_par17 spline_par18 
##  -0.14966276  -0.73667369  -0.50787230   1.76684715  -0.49802746   0.60068050 
## spline_par19 spline_par20 
##  -1.25445441  -0.25760822</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">### </span><span class="al">TESTING</span><span class="co">, REMOVE FROM VIGNETTE:</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">plot</span>(my_spline_GAI, <span class="dt">all_sites =</span> F, <span class="dt">useGGplot =</span> T)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Loading required package: reshape2</code></pre>
<pre><code>## Warning: package &#39;reshape2&#39; was built under R version 4.0.3</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --> If an incorrect number of starting values is given to fit_GAI, an error will be raised, and a printout will indicate the parameter starting values that fit_GAI expects. The order of these starting values is important, and matches the order of the output fit_GAI produces in this scenario. This feature should be used to avoid making mistakes when unsure of how many parameters a model specification will require. Confusingly, NA values are not allowed as starting values, but functionality exists within the code to aid in finding reasonable starting values, which is outlined later in this vignette.</p>
<p>It’s worth noting that multiple numerical methods exist for finding the MLEs of the GAI model. The package uses the ‘optim’ function which makes use of the “Nelder-Mead” algorithm by default, but this can be changed to other options, such as “BFGS” or “SANN” (simulated annealing) by passing in method = “SANN” (for example) as an argument to fit_GAI.</p>
<p></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># We cut off some of our starting parameters on purpose, to cause the exception</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># to be raised:</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">try</span>({my_mixture_GAI &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> example_par[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">DF =</span> example_data,</a>
<a class="sourceLine" id="cb15-4" title="4">                               <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;ZIP&quot;</span>,</a>
<a class="sourceLine" id="cb15-5" title="5">                               <span class="dt">options =</span> my_options, <span class="dt">verbose =</span> T,</a>
<a class="sourceLine" id="cb15-6" title="6">                               <span class="dt">hessian =</span> T)}, <span class="dt">silent =</span> T)</a></code></pre></div>
<pre><code>## [1] &quot;Incorrect number of parameters supplied. Please submit something similar to:&quot;
##      mu1      mu2      mu3    sigma       w1       w2 dist.par 
##       NA       NA       NA       NA       NA       NA       NA</code></pre>
</div>
<div id="including-covariates" class="section level1">
<h1>Including Covariates</h1>
<p>Models using ‘mixture’ and ‘stopover’ seasonal flight patterns are able to include covoariates on the values of the means, disperisions and weights for their normal distribution components.</p>
<p>Covariates can be included either as a general formula, which will apply to all broods, or be specified individually for each brood. Covariates for the normal components should be specified by adding a ‘mu_formula’, ‘sigma_formula’, or ‘w_formula’ to the ‘options argument’, for the mean, standard deviation, and for weights of each component, respectively.</p>
<p>When specifying covariate formulae one by one for each brood, we have the option of giving completely different formulae for each brood, or using NULL to specify that no covariates should be fitted for a given brood. Because of this flexibility, it is good practice to ensure the list of formulae always has the same number of elements as the number of broods specified. If more formulae are specified than there are broods, these extra formulae will simply be ignored.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># To specify a formula which will be identical for each brood, </span></a>
<a class="sourceLine" id="cb17-2" title="2">general_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">B =</span> <span class="dv">3</span>, <span class="dt">shared_sigma =</span> T,</a>
<a class="sourceLine" id="cb17-3" title="3">                        <span class="dt">mu_formula =</span> <span class="kw">formula</span>(<span class="op">~</span>altitude))</a>
<a class="sourceLine" id="cb17-4" title="4"></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co"># To be able to fit brood-specific covariate options for the standard deviations</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co"># we require the standard deviation to be estimated individually for each brood,</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co"># and so we set shared_sigma = F.</span></a>
<a class="sourceLine" id="cb17-8" title="8">brood_specific_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">B =</span> <span class="dv">3</span>, <span class="dt">shared_sigma =</span> F, </a>
<a class="sourceLine" id="cb17-9" title="9">                               <span class="dt">sigma_formula =</span></a>
<a class="sourceLine" id="cb17-10" title="10">                                 <span class="kw">list</span>(<span class="ot">NULL</span>,                     <span class="co"># for brood 1</span></a>
<a class="sourceLine" id="cb17-11" title="11">                                      <span class="kw">formula</span>(<span class="op">~</span>altitude),       <span class="co"># for brood 2</span></a>
<a class="sourceLine" id="cb17-12" title="12">                                      <span class="kw">formula</span>(<span class="op">~</span><span class="kw">I</span>(altitude<span class="op">^</span><span class="dv">2</span>)))) <span class="co"># for brood 3</span></a>
<a class="sourceLine" id="cb17-13" title="13"></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co"># The distributional parameter we had previously for the ZIP (Zero-Inflated </span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co"># Poisson) distribution will disappear now that we&#39;re fitting a simple </span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co"># Poisson. However, we are also adding a covariate formula which will require</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co"># one additional parameter. We&#39;ll give this a starting value of 0, which </span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co"># reflects an a priori belief that the covariate has no effect. To do this, </span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co"># we simply replace the final value of example par with 0, since distributional</span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co"># parameters are placed at the end of the parameter vector, and covariate are </span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co"># placed after these, when they are present:</span></a>
<a class="sourceLine" id="cb17-22" title="22">general_fit_start &lt;-<span class="st"> </span>example_par[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(example_par) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-23" title="23"></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="co"># Having specified our covariate formulae, we can fit the model in exactly the</span></a>
<a class="sourceLine" id="cb17-25" title="25"><span class="co"># same way as before:</span></a>
<a class="sourceLine" id="cb17-26" title="26">general_fit &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> general_fit_start, <span class="dt">DF =</span> example_data,</a>
<a class="sourceLine" id="cb17-27" title="27">                       <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</a>
<a class="sourceLine" id="cb17-28" title="28">                       <span class="dt">options =</span> general_options, <span class="dt">hessian =</span> T)</a>
<a class="sourceLine" id="cb17-29" title="29"></a>
<a class="sourceLine" id="cb17-30" title="30"><span class="co"># Because these covariate data are dummies, we expect the fitted value to be</span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="co"># very close to zero:</span></a>
<a class="sourceLine" id="cb17-32" title="32">general_fit<span class="op">$</span>par</a></code></pre></div>
<pre><code>##           mu1           mu2           mu3         sigma            w1 
##  1.4321946354  2.2380852400  2.1784445351  0.6017422656 -1.7864346889 
##            w2        mu.cov 
##  0.8494187230  0.0002585895</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># To make the starting values for the new model, we steal the known values from </span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co"># the example_par vector (using the shared standard deviation across broods as</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co"># the estimate for each brood individually). We then also add two 0s as our </span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co"># starting values for the covariate parameters</span></a>
<a class="sourceLine" id="cb19-5" title="5">brood_specific_start =<span class="st"> </span><span class="kw">c</span>(example_par[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">3</span>), <span class="dv">5</span><span class="op">:</span><span class="dv">6</span>)], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-6" title="6">brood_specific_fit &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> brood_specific_start,</a>
<a class="sourceLine" id="cb19-7" title="7">                              <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>,</a>
<a class="sourceLine" id="cb19-8" title="8">                              <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>, <span class="dt">hessian =</span> T,</a>
<a class="sourceLine" id="cb19-9" title="9">                              <span class="dt">options =</span> brood_specific_options)</a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co"># Checking the MLEs:</span></a>
<a class="sourceLine" id="cb19-11" title="11">brood_specific_fit<span class="op">$</span>par</a></code></pre></div>
<pre><code>##         mu1         mu2         mu3      sigma1      sigma2      sigma3 
##  1.43263822  2.23764857  2.17786835  0.62588867  0.59060074  0.65178441 
##          w1          w2  sigma2.cov  sigma3.cov 
## -1.76103674  0.85374271  0.01316131  0.01667243</code></pre>
<p>It should be noted that the GAI package comes with no methods for interpolating missing covariate values. Because of this, any NA covariate values in data.frame objects passed to fit_GAI will cause an error to be outputted to the console. The GAI package only supports ‘spatial’ covariates, that is, covariates whose values vary only by site, and are identical for every single sampling occasion, for a given site. Supplying time-varying covariates to fit_GAI will similarly lead to an error being thrown.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">example_NA &lt;-<span class="st"> </span>example_time_varying &lt;-<span class="st"> </span>example_data</a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co"># Turn roughly 5% of our altitude data to NA values:</span></a>
<a class="sourceLine" id="cb21-4" title="4">indices &lt;-<span class="st"> </span>example_NA<span class="op">$</span>altitude <span class="op">%&gt;%</span><span class="st"> </span>length <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb21-5" title="5">example_NA<span class="op">$</span>altitude[indices <span class="op">%&gt;%</span><span class="st"> </span>as.logical] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb21-6" title="6"></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co"># Turn our altitude data into a time-varying covariate by making it a function </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="co"># of the occasion:</span></a>
<a class="sourceLine" id="cb21-9" title="9">example_time_varying<span class="op">$</span>altitude &lt;-<span class="st"> </span>example_data<span class="op">$</span>altitude <span class="op">*</span><span class="st"> </span>example_data<span class="op">$</span>occasion</a>
<a class="sourceLine" id="cb21-10" title="10"></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="co"># Trying to fit a covariate model with these new data will throw the relevant</span></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="co"># errors:</span></a>
<a class="sourceLine" id="cb21-13" title="13">error_fit &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">fit_GAI</span>(<span class="dt">start =</span> general_fit_start, <span class="dt">DF =</span> example_NA,</a>
<a class="sourceLine" id="cb21-14" title="14">                         <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</a>
<a class="sourceLine" id="cb21-15" title="15">                         <span class="dt">options =</span> general_options, <span class="dt">hessian =</span> T))</a></code></pre></div>
<pre><code>## Error in design_matrix(DF, formulas) : Covariate values cannot include NA</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># Trying to fit with a time-varying formula: </span></a>
<a class="sourceLine" id="cb23-2" title="2">error_fit &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">fit_GAI</span>(<span class="dt">start =</span> general_fit_start, <span class="dt">DF =</span> example_time_varying,</a>
<a class="sourceLine" id="cb23-3" title="3">                         <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</a>
<a class="sourceLine" id="cb23-4" title="4">                         <span class="dt">options =</span> general_options, <span class="dt">hessian =</span> T))</a></code></pre></div>
<pre><code>## Error in get_cov_skeleton_and_DM(&quot;mu&quot;, options, DF, B, skeleton, DMs) : 
##   Covariate values must vary by site only, and not through time</code></pre>
</div>
<div id="finding-starting-values" class="section level1">
<h1>Finding Starting Values</h1>
<p>To aid numerical routines in estimating the maximum likelihood estimates of parameter values, link functions are used to ensure that parameter guesses can always be made on the entire real line. Because many broods can be used, the GAI package uses custom link functions for mean arrival times and dispersions, which are slightly more complicated that the typical log and logistic link functions.</p>
<p>The fit_GAI function expects all starting values to be given on this link scale, which can make using our intuition or knowledge of our data very difficult to produce good starting values. To remedy this, the transform_starting_values function can be used to transform parameter guesses on the ‘real world’ scale to the link scale.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># Let&#39;s produce a slightly &#39;annotated&#39; version of the plot of observed counts</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co"># we had before. We&#39;ll add in some lines where we think the mean brood arrival</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co"># times are, and add in horizontal lines to try to estimate thw standard </span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co"># deviation of each brood&#39;s arrivals:</span></a>
<a class="sourceLine" id="cb25-5" title="5">test_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">apply</span>(<span class="dv">2</span>, mean, <span class="dt">na.rm =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(test_data), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.6</span>), <span class="dt">lty =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb25-7" title="7">       <span class="dt">xlab =</span> <span class="st">&#39;Week&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Observed count, averaged across all sites&#39;</span>)</a>
<a class="sourceLine" id="cb25-8" title="8"></a>
<a class="sourceLine" id="cb25-9" title="9">plot.col &lt;-<span class="st"> &#39;blue&#39;</span></a>
<a class="sourceLine" id="cb25-10" title="10">plot.base &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb25-11" title="11"></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="co"># Mean brood arrival lines:</span></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="kw">lines</span>(<span class="kw">rep</span>(<span class="fl">4.1</span>, <span class="dv">2</span>), <span class="kw">c</span>(plot.base, <span class="fl">4.6</span>), <span class="dt">col =</span> plot.col)</a>
<a class="sourceLine" id="cb25-14" title="14"><span class="kw">lines</span>(<span class="kw">rep</span>(<span class="fl">13.0</span>, <span class="dv">2</span>), <span class="kw">c</span>(plot.base, <span class="fl">21.3</span>), <span class="dt">col =</span> plot.col)</a>
<a class="sourceLine" id="cb25-15" title="15"><span class="kw">lines</span>(<span class="kw">rep</span>(<span class="fl">23.0</span>, <span class="dv">2</span>), <span class="kw">c</span>(plot.base, <span class="dv">8</span>), <span class="dt">col =</span> plot.col) </a>
<a class="sourceLine" id="cb25-16" title="16"></a>
<a class="sourceLine" id="cb25-17" title="17"><span class="co"># Mean brood dispersion lines:</span></a>
<a class="sourceLine" id="cb25-18" title="18"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">7.5</span>), <span class="kw">rep</span>(plot.base, <span class="dv">2</span>), <span class="dt">col =</span> plot.col)</a>
<a class="sourceLine" id="cb25-19" title="19"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">18</span>), <span class="kw">rep</span>(plot.base, <span class="dv">2</span>), <span class="dt">col =</span> plot.col)</a>
<a class="sourceLine" id="cb25-20" title="20"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">26</span>), <span class="kw">rep</span>(plot.base, <span class="dv">2</span>), <span class="dt">col =</span> plot.col)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># The length of the three horizontal bars that measure the width of our broods:</span></a>
<a class="sourceLine" id="cb26-2" title="2">brood_widths &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">6.5</span>, <span class="dv">9</span>, <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb26-3" title="3"></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co"># Using a very rough rule of thumb that 95% of data in a normal distribution are</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co"># found within 1.96 standard deviations from the means, we use the half width of</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co"># our bars as an estimate of two sigma:</span></a>
<a class="sourceLine" id="cb26-7" title="7">sigma_guesses &lt;-<span class="st"> </span>brood_widths <span class="op">/</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb26-8" title="8"></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co"># Our guesses for the means can simply be read off of the lines of code that</span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="co"># produced the plot:</span></a>
<a class="sourceLine" id="cb26-11" title="11">mu_guesses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.1</span>, <span class="dv">13</span>, <span class="dv">23</span>)</a>
<a class="sourceLine" id="cb26-12" title="12"></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="co"># To guess the weights, we make the crude assumption that the height of the peak</span></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co"># of a brood relative to the others is roughly propoprtional to the percentage</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co"># of the population that finds itself in this brood:</span></a>
<a class="sourceLine" id="cb26-16" title="16">w_guesses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.6</span> <span class="op">-</span><span class="st"> </span>plot.base, <span class="fl">21.3</span> <span class="op">-</span><span class="st"> </span>plot.base, <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>plot.base) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="st">  </span>sum_to_one</a></code></pre></div>
<p>Let’s consider our brood_specific_fit once more, but using the transform_starting_values function to obtain better starting values, without knowing the distribution our data came from. The transform_starting_values function will assume that 0 is a reasonable starting value for all covariate parameters and spline parameters, which usually leads to numerically sound estimation of the MLEs. However, if covariates aren’t normalised, and have large magnitude, this won’t be the case.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># We create a list of starting values for parameters with the same structure </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co"># as the options argument for fit_GAI:</span></a>
<a class="sourceLine" id="cb27-3" title="3">my_starting_guesses &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">mu =</span> mu_guesses, <span class="dt">sigma =</span> sigma_guesses,</a>
<a class="sourceLine" id="cb27-4" title="4">                            <span class="dt">w =</span> w_guesses)</a>
<a class="sourceLine" id="cb27-5" title="5"></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co"># Note: When a ZIP or NB model is used, we can also include a guess for the</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co"># distributional parameter by adding in a dist.par entry to this list, and </span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co"># additionally a retention probability &#39;phi&#39; can be added for stopover models </span></a>
<a class="sourceLine" id="cb27-9" title="9">new_brood_specific_start &lt;-</a>
<a class="sourceLine" id="cb27-10" title="10"><span class="st">  </span><span class="kw">transform_starting_values</span>(<span class="dt">starting_values =</span> my_starting_guesses,</a>
<a class="sourceLine" id="cb27-11" title="11">                            <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</a>
<a class="sourceLine" id="cb27-12" title="12">                            <span class="dt">options =</span> brood_specific_options,</a>
<a class="sourceLine" id="cb27-13" title="13">                            <span class="co"># When covariates are included in the model, we </span></a>
<a class="sourceLine" id="cb27-14" title="14">                            <span class="co"># need to include the data.frame of observations and</span></a>
<a class="sourceLine" id="cb27-15" title="15">                            <span class="co"># covariate values, or the GAI package won&#39;t be able</span></a>
<a class="sourceLine" id="cb27-16" title="16">                            <span class="co"># to figure out how many parameters the model </span></a>
<a class="sourceLine" id="cb27-17" title="17">                            <span class="co"># specification requires. This can be omitted for</span></a>
<a class="sourceLine" id="cb27-18" title="18">                            <span class="co"># non-covariate-including models</span></a>
<a class="sourceLine" id="cb27-19" title="19">                            <span class="dt">DF =</span> example_data)</a>
<a class="sourceLine" id="cb27-20" title="20"></a>
<a class="sourceLine" id="cb27-21" title="21"><span class="co"># Let&#39;s print these new starting values, and refit the model:</span></a>
<a class="sourceLine" id="cb27-22" title="22"><span class="kw">print</span>(new_brood_specific_start)</a></code></pre></div>
<pre><code>##        mu1        mu2        mu3     sigma1     sigma2     sigma3         w1 
##  1.4109870  2.1860513  2.3025851  0.4855078  0.8109302  0.5596158 -2.0259529 
##         w2 sigma2.cov sigma3.cov 
##  1.0647107  0.0000000  0.0000000</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">new_brood_specific_fit &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> new_brood_specific_start,</a>
<a class="sourceLine" id="cb29-2" title="2">                                  <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>,</a>
<a class="sourceLine" id="cb29-3" title="3">                                  <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>, <span class="dt">hessian =</span> T,</a>
<a class="sourceLine" id="cb29-4" title="4">                                  <span class="dt">options =</span> brood_specific_options)</a>
<a class="sourceLine" id="cb29-5" title="5"><span class="co"># Checking the MLEs:</span></a>
<a class="sourceLine" id="cb29-6" title="6">new_brood_specific_fit<span class="op">$</span>par</a></code></pre></div>
<pre><code>##         mu1         mu2         mu3      sigma1      sigma2      sigma3 
##  1.41500508  2.24574295  2.18193605  0.65056697  0.59163927  0.60921230 
##          w1          w2  sigma2.cov  sigma3.cov 
## -1.76708274  0.86885953  0.01918536  0.07723517</code></pre>
</div>
<div id="using-bootstraps" class="section level1">
<h1>Using Bootstraps</h1>
<p>Bootstraps in the GAI package are available in two options. The first option will resample sites (and their covariate values) from the observed data set, refitting the model each time it does this. It then extracts the bootstrap distribution of estimated site superpopulation sizes and parameter estimates to create a quantile method confidence interval for these. Because this type of bootstrap can be incredibly computionally expensive, functionality has been provided to do these calculations in parallel.</p>
<p>The second method of bootstrapping involves resampling parameter values from their asymptotic multivariate normal distribution. This involves a numerical estimate of the Information matrix, and so is only available if a model has been fitted with the hessian = TRUE option in fit_GAI.</p>
<p>The second type of bootstrap runs considerably faster, and is likely to be the only available option when many sites or covariates have been included, due to computational constrains. However, it should be noted that the first type typically produces intervals with coverage closer to the target, as it has no dependence on asymptotic properties or estimates of the Information matrix.</p>
<p></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># To produce a bootstrap, we must specify if we wish to refit the model</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co"># (determining the type of bootstrap fitted), as well as the number of</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="co"># bootstrap resamples we would like to use (R):</span></a>
<a class="sourceLine" id="cb31-4" title="4">general_fit_bootstrap &lt;-<span class="st"> </span><span class="kw">bootstrap</span>(general_fit, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">refit =</span> F,</a>
<a class="sourceLine" id="cb31-5" title="5">                                   <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># The more time-consuming bootstrap can be fitted in parallel, with a chosen</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co"># number of cores. If this is not specified, the default number of cores </span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co"># will be one less than the number available on the computer, so this must</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co"># always be specifed if running models on a large server:</span></a>
<a class="sourceLine" id="cb34-5" title="5">refitting_bootstrap &lt;-<span class="st"> </span><span class="kw">bootstrap</span>(general_fit, <span class="dt">R =</span> <span class="dv">10</span>, <span class="dt">refit =</span> T, <span class="dt">parallel =</span> T,</a>
<a class="sourceLine" id="cb34-6" title="6">                                 <span class="dt">cores =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p>The bootstraps output contains raw values from each iteration of the estimated parameter values, the flight path densities for each site and occasioon, the estimated site totals (site superpopulations), and the average estimated site total. The <span class="math inline">\(1 - \alpha\)</span> confidence intervals are available in the $par, $sites and $index elements of the bootstrap output for the parameters, individual site totals and average site total, respectively:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Taking a look at the results of the &#39;refit the model at each iteration&#39;</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co"># style of bootstrap:</span></a>
<a class="sourceLine" id="cb35-3" title="3">refitting_bootstrap<span class="op">$</span>par</a></code></pre></div>
<pre><code>##            mu1      mu2      mu3     sigma        w1        w2        mu.cov
## 0.5%  1.419681 2.221178 2.156508 0.5841604 -1.830836 0.7883809 -0.0001399379
## 99.5% 1.464655 2.249502 2.198298 0.6316974 -1.709278 0.9382549  0.0044631581</code></pre>
</div>
<div id="model-outputs" class="section level1">
<h1>Model Outputs</h1>
<p>The GAI package comes with some simple functionality for summarising models, as well as more detailed outputs, which will be covered in more detail. The standard R ‘summary’ function can be used to see the model’s AIC, average estimate site total across all sites, and also the MLEs for all model parameters.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># Get a basic summary of the model outputs:</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">summary</span>(my_mixture_GAI)</a></code></pre></div>
<pre><code>## Maximum Likelihood Estimates (MLEs):
## 
##        mu1        mu2        mu3      sigma         w1         w2   dist.par 
##  1.4337144  2.2419175  2.1685968  0.6185839 -1.8263218  0.8410108  1.0687630 
## 
## 
## MLE Standard Errors:
## 
##         mu1         mu2         mu3       sigma          w1          w2 
## 0.019520275 0.009342360 0.007613442 0.011748868 0.040656331 0.033118484 
##    dist.par 
## 0.081908591 
## 
## 
## Akaike&#39;s Information Criterion (AIC): 3912.722 
## 
## Average estimated site super-population size: 109.45</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># We can also obtain the AIC on its own using the standard AIC R function if </span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co"># we aren&#39;t interested in producing the rest of the summary:</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="kw">AIC</span>(my_mixture_GAI)</a></code></pre></div>
<pre><code>## [1] 3912.722</code></pre>
<p>The output of the fit_GAI function is a list with a few important elements. The ‘par’ element gives named estimates of the MLEs for the model parameters, with ‘value’ giving the value of the negative log likelihood evaluated at the MLEs. ‘counts’, ‘convergence’, ‘message’ and ‘hessian’ are all standard outputs given by the optim function with details on the numerical process of estimating the MLEs. ‘spline_specs’ contains the user-specified options for fitting splines, and will be an empty list for mixture and stopover models. ‘dist_choice’ and ‘a_choice’ contain the count distribution and flight path distributions, respectively. Skeleton contains the skeleton list of parameter values that the package uses to fit the model, with ‘options’ being the list of options passed to fit_GAI. ‘maxiter’ refers to the maximum number of iterations used to estimate the MLEs of ZIP and NB models. ‘A’ and ‘N’ contain the matrix of estimated seasonal densities at each site and occasion, and the vector of estimated site totals, respectively. ‘DMs’ contains the list of design matrices used by the GAI package to include the selected covariate formulas in the model. ‘obs’ contains the count observations in matrix form, with sites as rows and occasions as columns. This is the same format as for ‘A’. ‘DF’ contains the original data.frame supplied to fit_GAI, and finally, ‘tol’ specififies the stopping condition used for the model (an epsilon such that during an iterative process for fitting a ZIP or NB model, a difference of less than epsilon in the negative log likelihood between two iterations causes the process to terminate).</p>
</div>
<div id="transforming-parameter-estimates" class="section level1">
<h1>Transforming Parameter Estimates</h1>
<p>Numerical solvers that attempt to find the MLEs must be able to perform guesses anywhere on the real scale. This causes issues with certain parameters which can only take on values in very particular ranges, such as probabilities which must always be between 0 and 1, for example. Further to this, the estimation of values such as mean arrival times for broods can be unidentifiable if specified ambiguously. In this example, unless we force the mean for the second brood to be greater than that for the first (and so forth), then multiple sets of parameters could give the same maximal value of the log likelihood. For these reasons, the GAI package uses link functions to map between the real line on which we make parameter value guesses during fitting, and the ‘parameter space line’, where all parameters are within the correct bounds.</p>
<p>In order to be able to interpret our output values, we must apply the relevant link functions to transform them back to the appropriate scale. For mu parameters this can be done with the means_link function. For standard deviations, a log-link is used, and so fitted values should be exponentiated. Weights also use a custom link function, which can be applied to fitted values using the probs_link function. The extra distributional parameter for the ZIP uses a logistic link (by virtue of being a probability), which can be applied with the qlogis function, whereas the rate parameter for an NB model should be exponentiated, to ensure it is always positive.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co"># The easiest way to obtain transformed parameter values on the correct scale</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="co"># is to use the transform_output function. This function uses the skeleton and</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="co"># options present in the fitted model object to apply covariate formulas before</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="co"># applying link functions.</span></a>
<a class="sourceLine" id="cb41-5" title="5">DF_to_transform &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">altitude =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb41-6" title="6"><span class="kw">transform_output</span>(brood_specific_fit, DF_to_transform)</a></code></pre></div>
<pre><code>##        mu1      mu2      mu3   sigma1   sigma2    sigma3        w1        w2
## 1 4.189738 13.56101 22.38848 1.869907 1.582471 10.165780 0.1466605 0.5984911
## 2 4.189738 13.56101 22.38848 1.869907 1.805072  1.918962 0.1466605 0.5984911
## 3 4.189738 13.56101 22.38848 1.869907 2.058986 10.165780 0.1466605 0.5984911</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># It&#39;s important to include all covariates exactly as they were named in the </span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co"># call to fit_GAI, otherwise an error will be thrown, giving the name of the </span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co"># missing covariate.</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="kw">try</span>(<span class="kw">transform_output</span>(brood_specific_fit, <span class="kw">data.frame</span>(<span class="dt">altiitude =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>))))</a></code></pre></div>
<pre><code>## Error in eval(predvars, data, env) : object &#39;altitude&#39; not found</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># NA covariate values will throw an error, as always:</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">try</span>(<span class="kw">transform_output</span>(brood_specific_fit, <span class="kw">data.frame</span>(<span class="dt">altitude =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">0</span>, <span class="dv">10</span>))))</a></code></pre></div>
<pre><code>## Error in design_matrix(DF, current_formula) : 
##   Covariate values cannot include NA</code></pre>
</div>
<div id="plotting-fitted-curves" class="section level1">
<h1>Plotting Fitted Curves</h1>
<p>The standard R plot function can be used to produce simple plots of the flight path of a fitted model. Optionally, either the flight path for each site can be included as a separate curve on the same graph, or a smooth can be plotted instead. This smooth averages through the different values observed at each site, at a set of quantiles that can be specified by the user. The default behaviour produces plots for the median density ocross sites for a given occasion, as well as the 5th and 95th quantiles for flight path density.</p>
<p>To better compare the relative abundance at each site throughout the year, especially when covariates have been included in the model, it can be useful to scale the flight path curve of each site by the estimated site total. This can be done by setting scale_by_N = TRUE in the call to the ‘plot’ function.</p>
<p>If custom colours are to be used by the plotting function, the colour palette can be passed to the ‘plot’ function as a vector of integers or character colour hex values using the ‘colours’ argument.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">colours &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#33FFF9&quot;</span>, <span class="st">&quot;#33A8FF&quot;</span>, <span class="st">&quot;#4233FF&quot;</span>)</a>
<a class="sourceLine" id="cb47-2" title="2"></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="co"># The default behaviour will use quantiles = c(0.05, 0.5, 0.95), and therefore </span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="co"># will not plot all sites individually. It will also use the standard R base</span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="co"># graphics colours. The shiftt parameter can be used to shift the legends if </span></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="co"># the default value places them incorrectly:</span></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="kw">plot</span>(general_fit, <span class="dt">scale_by_N =</span> T, <span class="dt">colours =</span> colours,</a>
<a class="sourceLine" id="cb47-8" title="8">     <span class="dt">quantiles =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="dt">shift =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.45</span>, <span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
